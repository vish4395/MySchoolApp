<!DOCTYPE html>
<html>
<head>
<title>My School App</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="lib/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="lib/font-awesome-4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
a{text-decoration: none;}
</style>
 
<script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
<script src="js/api_conf.js"></script>
 <script src="js/jquery.nicescroll.min.js"></script>
 </head>
<body class="w3-light-grey">

<!-- Top container -->
<div class="w3-container w3-top w3-black w3-large w3-padding" style="z-index:4">
  <button class="w3-btn w3-hide-large w3-padding-0 w3-hover-text-grey" onclick="w3_open();"><i class="fa fa-bars"></i>  Menu</button>
  <span class="w3-right">My School</span>
</div>

<!-- Sidenav/menu -->
<nav class="w3-sidenav w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidenav"><br>
  <div class="w3-container w3-row">
    <div class="w3-col s4">
      <img src="http://www.w3schools.com/w3images/avatar2.png" class="w3-circle w3-margin-right" style="width:46px">
    </div>
    <div class="w3-col s8">
      <span>Welcome, <br /> <strong id="APIusername">Mike</strong></span><br>
      <a href="#" class="w3-hover-none w3-hover-text-red w3-show-inline-block"><i class="fa fa-envelope"></i></a>
      <a href="#" class="w3-hover-none w3-hover-text-green w3-show-inline-block"><i class="fa fa-user"></i></a>
      <a href="#" class="w3-hover-none w3-hover-text-blue w3-show-inline-block"><i class="fa fa-cog"></i></a>
    </div>
  </div>
  <hr>
  <div class="w3-container">
    <h5>Dashboard</h5>
  </div>
  <a href="#" class="w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>
  <div class="sidebar-menu">
  
  </div>
  <br /> <br />
  <a href="Profile.html" class="w3-padding"><i class="fa fa-user fa-fw"></i>  Your Profile</a>
  <a href="Logout.html" class="w3-padding"><i class="fa fa-sign-out fa-fw"></i>  Logout</a><br><br>
  <a href="#" class="w3-padding"><i class="fa fa-cog fa-fw"></i>  Settings</a><br><br>
</nav>


<!-- Overlay effect when opening sidenav on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px;margin-top:43px;">

  <!-- Header -->
  <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa fa-dashboard"></i> My Dashboard</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom" id="summary_details">
    <div class="w3-quarter">
      <div class="w3-container w3-red w3-padding-16">
        <div class="w3-left"><i class="fa fa-comment w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>52</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Messages</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left"><i class="fa fa-eye w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>99</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Views</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-teal w3-padding-16">
        <div class="w3-left"><i class="fa fa-share-alt w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>23</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Shares</h4>
      </div>
    </div>
    <div class="w3-quarter">
      <div class="w3-container w3-orange w3-text-white w3-padding-16">
        <div class="w3-left"><i class="fa fa-users w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>50</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Users</h4>
      </div>
    </div>
  </div>

  <div class="w3-container w3-section">
    <div class="w3-row-padding" style="margin:0 -16px">
	<div class="w3-container">
  <h2>Notice</h2>

  <ul class="w3-ul w3-card-4 w3-white" id="recent_notices">
    <li class="w3-padding-16">
      <span onclick="this.parentElement.style.display='none'" 
      class="w3-closebtn w3-padding w3-margin-right w3-medium">&times;</span>
      <i class="fa fa-flag w3-xxxlarge"></i>
      <span class="w3-xlarge">Mike</span><br>
      <span>Web Designer</span>
    </li>
    
  </ul>
</div>
    </div>
  </div>
  <hr>

  <!-- Footer -->
  <footer class="w3-container w3-padding-16 w3-light-grey">
    <h4>FOOTER</h4>
    <p>Powered by <a href="http://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
  </footer>

  <!-- End page content -->
</div>

<script>
// Get the Sidenav
var mySidenav = document.getElementById("mySidenav");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidenav, and add overlay effect
function w3_open() {
    if (mySidenav.style.display === 'block') {
        mySidenav.style.display = 'none';
        overlayBg.style.display = "none";
    } else {
        mySidenav.style.display = 'block';
        overlayBg.style.display = "block";
    }
}

// Close the sidenav with the close button
function w3_close() {
    mySidenav.style.display = "none";
    overlayBg.style.display = "none";
}
</script>
<script type="text/javascript">
$(document).ready(

  function() { 
    $("html").niceScroll();
//	$("#mySidenav").niceScroll({cursorcolor:"#003"});
  }

);
</script>
<script>
			var childId = '';
$(function () {
//                $.mobile.loading( 'show', {
//                        text: 'Loading...',
//                        textVisible: true,
//                        theme: 'b',
//                        html: ""
//                });
    var secret = localStorage.getItem("secret");
	$(".sidebar-menu").html(localStorage.getItem("nav_html"));
	$("#summary_details").html(localStorage.getItem("summary_html"));
	$("#APIusername").html(localStorage.getItem("name_user"));
    console.log(secret);
    if (secret == null)
    {
        window.location.href = 'index.html';
    }

    $('#children').change(function () {
        childId = $('#children').val();
        if (childId != '') {
            localStorage.setItem("childId", childId);
            window.location.href = 'student_dashboard.html';
        }
    });





    $.ajax({
        type: "POST",
        //                url: "http://thethirdthought.in/schoolapp/index.php/user/dashboardetails",
        url: apiUrl + "dashboardetails.php",
        data: {'secret': secret},
        datatype: "json",
        success: function (result) {
            var obj = $.parseJSON(result);
            if (obj.success)
            {
               
//                            $.mobile.loading( 'hide');

                var nav_html = '';
                $.each(obj.navigation.parent, function (i, obj_navigation) {
//                                console.log(obj_navigation);
                    if (obj_navigation.child) {
                        nav_html += '<div class="w3-accordion w3-red"><button onclick="NavChild(\'' + obj_navigation.title + '\')" class="w3-btn-block w3-white w3-hover-light-grey w3-left-align"><i class="fa ' + obj_navigation.faicon + ' fa-fw"></i> ' + obj_navigation.title + '</button> <div id="' + obj_navigation.title + '" class="w3-accordion-content w3-container">';
                    } else {
                        //nav_html += '<li ><a href="' + obj_navigation.url + '"> <i class="fa fa-lock"></i><span>' + obj_navigation.title + '</span></a>';
                        nav_html += '<a href="' + obj_navigation.url + '" class="w3-btn-block w3-white w3-hover-light-grey w3-left-align"><i class="fa ' + obj_navigation.faicon + ' fa-fw"></i>  ' + obj_navigation.title + '</a>';
                    }
                    if (obj_navigation.child) {
                        $.each(obj_navigation.child, function (i, obj_subnav) {
                            nav_html += '<a href="' + obj_subnav.url + '">' + obj_subnav.title + '</a>';
                        });
                    }
                    nav_html += '</div></div>';
                });

                var summary_html = '';
                if (obj.summary != null) {
                    $.each(obj.summary, function (i, obj_summary) {
					var colors = Array('w3-red','w3-orange','w3-yellow','w3-green','w3-blue','w3-purple','w3-black','w3-teal','w3-pink','w3-indigo','w3-brown','w3-cyan','w3-gray','w3-lime','w3-khaki','w3-white');
					
					//var color = colors[Math.floor(Math.random()*colors.length)];
                        //summary_html += '<div class="col-lg-3 col-xs-6"><a href="' + obj_summary.link + '"><div class="small-box bg-aqua"><div class="inner"><h3>' + obj_summary.count + '</h3><p>' + obj_summary.title + '</p></div><div class="icon"><i class="ion ion-bag"></i></div></div></a></div>';
                        summary_html += '<div class="w3-quarter"> <a href="' + obj_summary.link + '"><div class="w3-container ' + colors[Math.floor(Math.random()*colors.length)] + ' w3-padding-16"> <div class="w3-left"><i class="fa ' + obj_summary.faicon + ' w3-xxxlarge"></i></div> <div class="w3-right">          <h3>' + obj_summary.count + '</h3>        </div>        <div class="w3-clear"></div>        <h4>' + obj_summary.title + '</h4>   </div>  </a>  </div>';
                    });
                }
                var news_html = '';
                if (obj.notices) {
                    $.each(obj.notices, function (i, obj_notices) {
                       // news_html += '<li><a href="javascript::;"><i class="menu-icon fa fa-birthday-cake bg-red"></i><div class="menu-info"><h4 class="control-sidebar-subheading">' + obj_notices.title + '</h4><p>' + obj_notices.description + '</p><p>' + obj_notices.date + '</p></div></a></li>';
                        news_html += '<li class="w3-padding-16"><span onclick="this.parentElement.style.display=\'none\'"       class="w3-closebtn w3-padding w3-margin-right w3-medium">&times;</span>  <i class="fa fa-flag w3-xxxlarge"></i>&emsp;   <span class="w3-xlarge">' + obj_notices.subject + '</span>   -     <span>' + obj_notices.description + '</span>    </li>';
                    })
                }
//                            console.log(obj.notices);

                if (!obj.profile_detail.image)
                {
                    obj.profile_detail.image = "dist/images/no-image.png";
                }
                if (!obj.profile_detail.avtar)
                {
                    obj.profile_detail.avtar = "no-image.png";
                }
                $("#profile_image_top_right img").attr('src', uploadpath + obj.profile_detail.avtar);
                $("#top_right_user_detail").html(obj.profile_detail.name);
                $("#APIusername").html(obj.profile_detail.name.toUpperCase());
                $("#profile_image_left_bar img").attr('src', uploadpath + '/' + obj.profile_detail.avtar);
                $("#profile_image_top_right_click img").attr('src', uploadpath + '/' + obj.profile_detail.avtar);
                $("#user_detail_left_bar p").html(obj.profile_detail.name);
                $("#summary_details").html(summary_html);
                $("#recent_notices").html(news_html);
                $(".sidebar-menu").html(nav_html);


                localStorage.setItem("img_user", uploadpath + '/' + obj.profile_detail.avtar);
                localStorage.setItem("name_user", obj.profile_detail.name);
                localStorage.setItem("summary_html", summary_html);
                localStorage.setItem("news_html", news_html);
                localStorage.setItem("nav_html", nav_html);

                //                        User Details
                if (obj.profile_detail.name != null)
                    localStorage.setItem("userdetails_name", obj.profile_detail.name);
                if (obj.profile_detail.address != null)
                    localStorage.setItem("userdetails_address", obj.profile_detail.address);
                if (obj.profile_detail.phone != null)
                    localStorage.setItem("userdetails_phone", obj.profile_detail.phone);
                if (obj.profile_detail.city != null)
                    localStorage.setItem("userdetails_city", obj.profile_detail.city);
                if (obj.profile_detail.zipcode != null)
                    localStorage.setItem("userdetails_zip", obj.profile_detail.zipcode);

            }
            else
            {
                $("#form_error").html("");
                $("#form_error").html(obj.msg);
            }
        },
        error: function () {
            console.log("Some Error Occured");
        }
    });
});


		</script>
		<script>
function NavChild(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>
</body>
</html>
